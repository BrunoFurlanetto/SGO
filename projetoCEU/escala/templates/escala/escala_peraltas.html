{% extends 'base.html' %}
{% load static %}
{% include 'parciais/_head.html' %}

{% block conteudo %}
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}"> <!-- Styles da bootstrap -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}"> <!-- Styles da bootstrap -->

    <div class="conteudo-escala" style="background-color: white">
        <div id="selecionar_setor">
            <label>Setor</label>
            <select class="form-select" name="setor" id="setor">
                <option selected></option>
                <option value="Acampamento">Acampamento</option>
                <option value="Hotelaria">Hotelaria</option>
            </select>
        </div>
        <div id="calendar" class="card" style="padding: 10px; background-color: transparent; border: none"></div>
          {% csrf_token %}
        <script src="{% static 'fullcalendar/lib/main.js' %}"></script><!-- Script para o calendário da escala -->

        <script>
            document.addEventListener('DOMContentLoaded', function(){
                var calendarUI = document.getElementById('calendar');
                var calendar = new FullCalendar.Calendar(calendarUI,{

                    headerToolbar: {
                        left: '',
                        center: 'title',
                    },
                    eventOrderStrict: true,
                    locale: 'pt-br',
                    dayMaxEvents: 3,

                    {% if edita %}
                        navLinks: true,
                        navLinkDayClick: function(date, jsEvent){
                            window.location.href = "{% url 'escalar_monitores' 'acampamento' '25-05-2022' %}"
                        },

                    {% endif %}

                    events: [
                        {% for escala in escalas %}
                            {% for professor in escala.separar_equipe %}
                                {
                                    title: "{{ forloop.counter }} {{ professor }}",
                                    start: "{{ escala.data | date:'Y-m-d' }}",

                                    {% if user.first_name == professor %}
                                      color: '#fcc607',
                                      textColor: 'black'
                                    {% endif %}
                                },
                            {% endfor %}
                        {% endfor %}
                    ]

                });
                calendar.render();
                calendar.setOption('locale', 'pt-br')
            });
        </script>

    <div class="modal fade" id="ModalCadastro" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Cadastro de escala</h5>
            <button class="x-fechar-modal" data-bs-dismiss="modal" >
              <span aria-hidden="false" >&times;</span>
            </button>
          </div>
          <form action="{% url 'escala' %}" method="POST">
            <div class="modal-body">
                {% csrf_token %}
                <div class="row" style="width: 90%; margin: 0">
                    <label>Cliente</label>
                    <select class="form-select" name="cliente" id="clientes_dia">
                        <option selected></option>
                    </select>
                </div>
                <hr>
                <div class="row">
                    <div class="row" style="width: 50%">
                    </div>
                    <div style="width: 45%">
                      <b>Monitores disponiveis na data selecionada:</b>
                      <ul class="disponiveis"></ul>
                    </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-primary">Salvar escala</button>
            </div>
            <script src="{% static 'js/script_base.js' %}"></script>
          </form>
        </div>
      </div>
        <script src="{% static 'js/bootstrap.min.js' %}"></script><!-- Script para o calendário da escala -->
    </div>

    </div>



{% endblock %}

